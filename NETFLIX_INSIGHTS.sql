SELECT *
FROM Netflix_Userbase

--WHAT TYPE OF SUBSCRIPTION MOST USERS ARE USING

SELECT TOP 1 SUBSCRIPTION_TYPE, COUNT(SUBSCRIPTION_TYPE) AS MOST_USED_SUBSCRIPTION
FROM Netflix_Userbase
GROUP BY SUBSCRIPTION_TYPE


--WHAT SUSBCRIPTION_TYPE GIVES MOST REVENUE

SELECT TOP 1 SUBSCRIPTION_TYPE, SUM(Monthly_Revenue) AS MOST_REVENUE_GENERATED
FROM Netflix_Userbase
GROUP BY SUBSCRIPTION_TYPE
order by SUM(Monthly_Revenue) DESC

--WHICH COUNTRY IS MOSTLY USING NETFLIX AND NO. OF SUBSCRIPTION

SELECT TOP  1 COUNTRY, COUNT(COUNTRY) NO_OF_SUBSCRIPTION
FROM Netflix_Userbase
GROUP BY Country

--HOW MANY MALES LESS THAN 30 ARE USING NETFLIX

SELECT GENDER, COUNT(AGE) NO_OF_PEOPLE
FROM Netflix_Userbase
WHERE GENDER = 'MALE' AND AGE < 30
GROUP BY GENDER

--HOW MANY FEMALES OVER 35 ARE USING NETFLIX

SELECT GENDER, COUNT(AGE) NO_OF_PEOPLE
FROM Netflix_Userbase
WHERE GENDER = 'FEMALE' AND AGE > 35
GROUP BY GENDER


--HOW MANY MALES USES PREMIUM SUBSCRIPTIONS

SELECT GENDER, COUNT(Subscription_Type) NO_OF_PEOPLE
FROM Netflix_Userbase
WHERE GENDER = 'MALE' AND Subscription_Type = 'PREMIUM'
GROUP BY GENDER

--NO. OF BASIC SUBSRIPTION BY EACH COUNTRY

SELECT COUNTRY, COUNT(SUBSCRIPTION_TYPE) NO_OF_SUBSCRIPTION
FROM Netflix_Userbase
WHERE SUBSCRIPTION_TYPE = 'BASIC'
GROUP BY Country
ORDER BY COUNT(SUBSCRIPTION_TYPE) DESC

--HOW MANY SUBSCRIPTIONS ARE GOING TO BE ENDED BY THE END OF JULY

SELECT COUNT(LAST_PAYMENT_DATE) SUBSCRIPTIONS_TO_BE_EXPIRED
FROM Netflix_Userbase
WHERE LAST_PAYMENT_DATE >= '2023-06-30'

--REVENUE GENERATED BY EACH SUBSCRIPTION

SELECT SUBSCRIPTION_TYPE, SUM(MONTHLY_REVENUE) AS REVENUE_GENERATED
FROM Netflix_Userbase
GROUP BY SUBSCRIPTION_TYPE

--AMOUNT OF REVENUE EACH COUNTRY GIVES

SELECT DISTINCT(COUNTRY), SUM(MONTHLY_REVENUE) AS REVENUE
FROM Netflix_Userbase
GROUP BY COUNTRY
ORDER BY SUM(MONTHLY_REVENUE)

--LOWEST REVENUE COUNTRY AND ITS REVENUE

SELECT  TOP 1 (COUNTRY), SUM(MONTHLY_REVENUE) AS LEAST_REVENUE
FROM Netflix_Userbase
GROUP BY COUNTRY
ORDER BY SUM(MONTHLY_REVENUE)